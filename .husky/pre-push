# Skip hooks in CI environments
[ -n "$CI" ] && exit 0

echo "ğŸ” Running pre-push qualification checks..."
echo ""

# 1. ESLint
echo "ğŸ“‹ Running ESLint..."
pnpm lint || {
    echo "âŒ ESLint failed. Run 'pnpm lint:fix' to auto-fix."
    exit 1
}
echo "âœ… ESLint passed!"
echo ""

# 2. Prettier
echo "ï¿½ Checking code formatting..."
pnpm format:check || {
    echo "âŒ Prettier check failed. Run 'pnpm format' to auto-fix."
    exit 1
}
echo "âœ… Prettier passed!"
echo ""

# 3. TypeScript
echo "ï¿½ Type checking..."
pnpm typecheck || {
    echo "âŒ Type check failed. Please fix TypeScript errors."
    exit 1
}
echo "âœ… Type check passed!"
echo ""

# 4. Tests with coverage
echo "ğŸ§ª Running tests with coverage..."
pnpm vitest run --coverage || {
    echo "âŒ Tests failed. Please fix failing tests or coverage."
    exit 1
}
echo "âœ… All tests passed with coverage!"
echo ""

# 5. Build
echo "ğŸ—ï¸  Verifying build..."
pnpm build || {
    echo "âŒ Build failed. Please fix build errors."
    exit 1
}
echo "âœ… Build passed!"
echo ""

# 6. Electron build
echo "âš¡ Verifying Electron build..."
pnpm electron:build || {
    echo "âŒ Electron build failed. Please fix Electron build errors."
    exit 1
}

# 7. E2E Tests
echo "ğŸš€ Running Electron E2E tests..."
pnpm test:e2e || {
    echo "âŒ E2E tests failed. Please fix E2E test errors."
    exit 1
}
echo "âœ… E2E tests passed!"
echo ""

echo "ğŸš€ All pre-push checks passed! Ready to push!"
